<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <title>Leaflet</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
        integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
        crossorigin="" />
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
        }

        body {
            padding: 0;
            margin: 0;
        }

        #map_canvas {
            width: 100%;
            height: 100%;
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>

<body onload="initialize()">
    <div id="map_canvas"></div>
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
        integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
        crossorigin=""></script>

    <script>
        /*---------------------------------------------------
        * Hochschule für Technik Stuttgart
        * Fachbereich Vermessung, Informatik und Mathematik
        * Schellingstr. 24
        * D-70174 Stuttgart
        *
        * Volker Coors
        * 7.11.2018
        *
        * GeoVisualisierung
        * 
        * ------------------------------------------------*/
        var map
        /**
        * Die Methode initialize wird beim Laden der Webseite aufgerufen
        * durch HTML <body onload="initialize()">, siehe unten.
        */
        function loadJSON(callback) {
            let request = new XMLHttpRequest();
            request.overrideMimeType("application/json");
            //request.open('GET', 'https://unstats.un.org/SDGAPI/v1/sdg/Target/Data?target=6.1&target=6.2&areaCode=112&areaCode=100&areaCode=203&areaCode=348&areaCode=616&areaCode=498&areaCode=642&areaCode=643&areaCode=703&areaCode=804&areaCode=208&areaCode=233&areaCode=234&areaCode=246&areaCode=352&areaCode=372&areaCode=833&areaCode=428&areaCode=440&areaCode=578&areaCode=744&areaCode=752&areaCode=826&areaCode=8&areaCode=20&areaCode=70&areaCode=191&areaCode=292&areaCode=300&areaCode=336&areaCode=380&areaCode=470&areaCode=499&areaCode=807&areaCode=620&areaCode=674&areaCode=688&areaCode=705&areaCode=724&areaCode=40&areaCode=56&areaCode=250&areaCode=276&areaCode=438&areaCode=442&areaCode=492&areaCode=528&areaCode=756&timePeriod=2015&timePeriod=2016&timePeriod=2017', true);
            //Europe: request.open('GET', 'https://unstats.un.org/SDGAPI/v1/sdg/Target/Data?target=6.1&target=6.2&areaCode=150&timePeriod=2015&timePeriod=2016&timePeriod=2017', true);
            request.open('GET', 'https://unstats.un.org/SDGAPI/v1/sdg/Target/Data?target=6.1&target=6.2&areaCode=112&areaCode=100&areaCode=203&areaCode=348&areaCode=616&areaCode=498&areaCode=642&areaCode=643&areaCode=703&areaCode=804&areaCode=208&areaCode=233&areaCode=234&areaCode=246&areaCode=352&areaCode=372&areaCode=833&areaCode=428&areaCode=440&areaCode=578&areaCode=744&areaCode=752&areaCode=826&areaCode=8&areaCode=20&areaCode=70&areaCode=191&areaCode=292&areaCode=300&areaCode=336&areaCode=380&areaCode=470&areaCode=499&areaCode=807&areaCode=620&areaCode=674&areaCode=688&areaCode=705&areaCode=724&areaCode=40&areaCode=56&areaCode=250&areaCode=276&areaCode=438&areaCode=442&areaCode=492&areaCode=528&areaCode=756&timePeriod=2015&timePeriod=2016&timePeriod=2017&pageSize=829', true);
            request.onreadystatechange = function () {
                if (request.readyState == 4 && request.status == "200") {
                    callback(request.responseText);
                }
            };
            request.send(null);
        }

        function initialize() {
            loadJSON(function (response) {
                // Parse JSON string into object
                let json = JSON.parse(response);
                console.log(json);
                
                json.data.forEach(element => {
                    console.log(element.geoAreaName)
                });
            });


            /**
          
            * zoom level: 0 - 18
            * 
            * 0 - Weltkarte
            *  ...
            * 18 - Einzelgebäue
            *
            * siehe https://leafletjs.com/examples/zoom-levels/
            * 
            * setView:
            * der erste Paramter definiert den Mittelpunkt der Karte in 
            * Längen- und Breitengrad (Koordinatensystem WGS 84)
            *
            * Stuttgart - [48.81, 9.16]
            * Sidney - [-33.51, 151.12]
            *
            */
            map = L.map('map_canvas').setView([53.81, 14.16], 3.5);
            /**
            * Die Karte basiert auf OpenStreetmap Daten und wird von Mapbox als gekachelte 
            * Rasterkarte bereitgestellt. Leider ist die Nutzung von MapBox auch mit einem 
            * Geschäftsmodell verbunden, siehe https://www.mapbox.com/pricing/
            * Aber bei geringer Nutzung sind die Karten kostenfrei.
            * Als access token wird das token aus dem Leaflet Quickstart verwendet:
            * https://leafletjs.com/examples/quick-start/
            *
            * anstelle einer Strassenkarte können auch Satellitenbilder genutzt werden:
            * id: 'mapbox.satellite'
            */
            var osm = new L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'Map data © <a href="https://openstreetmap.org">OpenStreetMap</a> contributors',
                minZoom: 2,
                maxZoom: 18
            });
            map.addLayer(osm);
            /**
            * place marker with balloon
            * and user defines Icon
            *   
            */

        }
    </script>
</body>

</html>